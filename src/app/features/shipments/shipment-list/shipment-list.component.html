<app-navbar></app-navbar>

<div class="container">
  <div class="header">
    <h1>GestiÃ³n de EnvÃ­os</h1>
    <button class="btn btn-primary" routerLink="/shipments/create">
      + Nuevo EnvÃ­o
    </button>
  </div>

  <div class="card" *ngIf="loading">
    <p class="text-center">Cargando envÃ­os...</p>
  </div>

  <div class="card" *ngIf="!loading && shipments.length === 0">
    <p class="text-center">No hay envÃ­os registrados</p>
  </div>

  <div class="table-container" *ngIf="!loading && shipments.length > 0">
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Nro. Seguimiento</th>
          <th>Origen â†’ Destino</th>
          <th>Remesa</th>
          <th>Manifiesto</th>
          <th>Placa</th>
          <th>Peso (kg)</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let shipment of shipments">
          <td>{{ shipment.id }}</td>
          <td><strong>{{ shipment.tracking_number }}</strong></td>
          <td>
            <span class="route">
              {{ shipment.origin }} â†’ {{ shipment.destination }}
            </span>
          </td>
          <td>{{ shipment.remesa || '-' }}</td>
          <td>{{ shipment.manifiesto || '-' }}</td>
          <td>
            <span class="plate" *ngIf="shipment.plate">ğŸšš {{ shipment.plate }}</span>
            <span *ngIf="!shipment.plate">-</span>
          </td>
          <td>
            <span *ngIf="shipment.weight">{{ shipment.weight }} kg</span>
            <span *ngIf="!shipment.weight">-</span>
          </td>
          <td>
            <span class="badge" [class.badge-success]="shipment.is_active" [class.badge-danger]="!shipment.is_active">
              {{ shipment.is_active ? 'âœ“ Activo' : 'âœ— Inactivo' }}
            </span>
          </td>
          <td>
            <div class="action-buttons">
              <button class="btn btn-sm btn-secondary" (click)="viewShipment(shipment.id)" title="Ver detalles">
                ğŸ‘ï¸
              </button>
              <button class="btn btn-sm btn-primary" (click)="editShipment(shipment.id)" title="Editar">
                âœï¸
              </button>
              <button 
                class="btn btn-sm" 
                [class.btn-warning]="shipment.is_active"
                [class.btn-success]="!shipment.is_active"
                (click)="toggleActive(shipment)" 
                [title]="shipment.is_active ? 'Desactivar' : 'Activar'">
                {{ shipment.is_active ? 'â¸ï¸' : 'â–¶ï¸' }}
              </button>
              <button class="btn btn-sm btn-danger" (click)="deleteShipment(shipment.id)" title="Eliminar">
                ğŸ—‘ï¸
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="pagination" *ngIf="!loading && shipments.length > 0">
    <button class="btn btn-secondary" (click)="previousPage()" [disabled]="currentPage === 1">
      â† Anterior
    </button>
    <span class="pagination-info">
      PÃ¡gina {{ currentPage }} de {{ totalPages }} ({{ totalItems }} registros)
    </span>
    <button class="btn btn-secondary" (click)="nextPage()" [disabled]="currentPage === totalPages">
      Siguiente â†’
    </button>
  </div>
</div>
